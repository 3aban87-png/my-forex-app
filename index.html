<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root { --bg: #0f172a; --card: #1e293b; --blue: #3b82f6; --green: #22c55e; --red: #ef4444; --text: #f8fafc; }
        body { font-family: Tahoma; background: var(--bg); color: var(--text); margin: 0; padding-bottom: 90px; }
        .stats-bar { background: var(--card); padding: 15px; margin: 10px; border-radius: 12px; border: 1px solid var(--blue); display: flex; justify-content: space-around; font-weight: bold; }
        .page { display: none; padding: 15px; } .active-p { display: block; }
        .card { background: var(--card); border-radius: 12px; padding: 15px; margin-bottom: 10px; border: 1px solid #334155; }
        .navbar { position: fixed; bottom: 0; width: 100%; background: var(--card); display: flex; justify-content: space-around; padding: 10px 0; border-top: 1px solid #334155; }
        .nav-item { background: none; border: none; color: #94a3b8; font-size: 9px; display: flex; flex-direction: column; align-items: center; cursor: pointer; }
        .nav-item.on { color: var(--blue); }
    </style>
</head>
<body>
    <div class="stats-bar">
        <span>Ø¨Ø±Ø¢ÛŒÙ†Ø¯ Ú©Ù„: <span id="total-pips" style="color:var(--green)">0</span> Pip</span>
    </div>

    <div id="p-signals" class="page active-p"><h3>Ø³ÛŒÚ¯Ù†Ø§Ù„â€ŒÙ‡Ø§ÛŒ ÙØ¹Ù„ÛŒ</h3><div id="list-s"></div></div>
    <div id="p-history" class="page"><h3>ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ù…Ø¹Ø§Ù…Ù„Ø§Øª</h3><div id="list-h"></div></div>
    <div id="p-copy" class="page"><h3>Ú©Ù¾ÛŒâ€ŒØªØ±ÛŒØ¯</h3><div class="card">ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø­Ø³Ø§Ø¨...</div></div>
    <div id="p-calc" class="page"><h3>Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø­Ø¬Ù…</h3><input type="number" id="b" placeholder="Ù…ÙˆØ¬ÙˆØ¯ÛŒ"><button onclick="alert('Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø´Ø¯')">Ù…Ø­Ø§Ø³Ø¨Ù‡</button></div>
    <div id="p-news" class="page"><h3>Ø§Ø®Ø¨Ø§Ø±</h3><p>Ø®Ø¨Ø± Ø¬Ø¯ÛŒØ¯ÛŒ Ù†ÛŒØ³Øª</p></div>
    <div id="p-supp" class="page"><h3>Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ</h3><button>Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù…</button></div>

    <nav class="navbar">
        <button class="nav-item" onclick="tab('p-supp')"><i>ğŸ§</i>Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ</button>
        <button class="nav-item" onclick="tab('p-news')"><i>ğŸ“¢</i>Ø§Ø®Ø¨Ø§Ø±</button>
        <button class="nav-item" onclick="tab('p-calc')"><i>ğŸ§®</i>Ù…Ø­Ø§Ø³Ø¨Ù‡</button>
        <button class="nav-item" onclick="tab('p-history')"><i>ğŸ“œ</i>ØªØ§Ø±ÛŒØ®Ú†Ù‡</button>
        <button class="nav-item" onclick="tab('p-copy')"><i>ğŸ”„</i>Ú©Ù¾ÛŒâ€ŒØªØ±ÛŒØ¯</button>
        <button class="nav-item on" onclick="tab('p-signals')"><i>ğŸ“ˆ</i>Ø³ÛŒÚ¯Ù†Ø§Ù„</button>
    </nav>

    <script>
        function tab(id) {
            document.querySelectorAll('.page').forEach(p=>p.classList.remove('active-p'));
            document.querySelectorAll('.nav-item').forEach(i=>i.classList.remove('on'));
            document.getElementById(id).classList.add('active-p');
            event.currentTarget.classList.add('on');
        }

        async function update() {
            try {
                const res = await fetch('http://localhost:8000/data');
                const d = await res.json();
                document.getElementById('total-pips').innerText = d.total_pips;
                
                // Ù„ÛŒØ³Øª Ø³ÛŒÚ¯Ù†Ø§Ù„
                let sHtml = '';
                d.active.forEach(s => {
                    sHtml += `<div class="card" style="border-right:4px solid ${s.type=='BUY'?'#22c55e':'#ef4444'}">
                        <b>${s.symbol} | ${s.type}</b><br><small>ÙˆØ±ÙˆØ¯: ${s.entry} | TP: ${s.tp}</small></div>`;
                });
                document.getElementById('list-s').innerHTML = sHtml || 'Ø³ÛŒÚ¯Ù†Ø§Ù„ Ø¨Ø§Ø² Ù†ÛŒØ³Øª';

                // Ù„ÛŒØ³Øª ØªØ§Ø±ÛŒØ®Ú†Ù‡
                let hHtml = '';
                d.history.forEach(h => {
                    hHtml += `<div class="card"><span>${h.symbol}</span> <b style="float:left; color:${h.pips>=0?'#22c55e':'#ef4444'}">${h.pips:+} Pip</b></div>`;
                });
                document.getElementById('list-h').innerHTML = hHtml || 'ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª';
            } catch(e) {}
        }
        setInterval(update, 3000); update();
    </script>
</body>
</html>
