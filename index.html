<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { font-family: Tahoma; background: #0f172a; color: white; text-align: center; padding-bottom: 80px; }
        .card { background: #1e293b; border-radius: 10px; padding: 15px; margin: 10px; border: 1px solid #334155; }
        .page { display: none; } .active { display: block; }
        .nav { position: fixed; bottom: 0; width: 100%; background: #1e293b; display: flex; padding: 10px 0; }
        .nav button { flex: 1; color: #94a3b8; background: none; border: none; font-size: 12px; }
        .nav button.on { color: #3b82f6; }
    </style>
</head>
<body>
    <h2 id="title">سیگنال‌های زنده</h2>
    <div id="signals-container" class="page active">در حال بارگذاری سیگنال‌ها...</div>
    <div id="copy-page" class="page"><h3>تنظیمات کپی‌ترید</h3><p>به زودی...</p></div>

    <div class="nav">
        <button onclick="show('copy-page', 'کپی‌ترید')">کپی‌ترید</button>
        <button class="on" onclick="show('signals-container', 'سیگنال‌ها')">سیگنال‌ها</button>
    </div>

    <script>
        function show(id, title) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.getElementById('title').innerText = title;
        }

        async function updateSignals() {
            try {
                // آدرس لوکال شما (باید با Ngrok عمومی شود تا روی گوشی کار کند)
                const res = await fetch('http://localhost:8000/signals');
                const data = await res.json();
                const container = document.getElementById('signals-container');
                container.innerHTML = data.length ? '' : 'سیگنال فعالی نیست';
                data.forEach(s => {
                    container.innerHTML += `<div class="card">
                        <b>${s.symbol}</b> <span style="color:${s.type=='BUY'?'#2ecc71':'#ef4444'}">${s.type}</span><br>
                        <small>Entry: ${s.entry} | SL: ${s.sl} | TP: ${s.tp}</small>
                    </div>`;
                });
            } catch (e) { console.log("API Error"); }
        }
        setInterval(updateSignals, 3000);
        updateSignals();
    </script>
</body>
</html>
